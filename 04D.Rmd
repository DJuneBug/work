---
title: 'Part 4: Systems with time delays'
subtitle: "D. Exercises"
author: "Mingyang Lu"
date: "08/18/2023"
output:
  html_document:
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Anorther bifurcation analysis

Consider the circuit with one self-inhibiting gene, described by Equation (1) in Part 4A. Now, we would like to plot a bifurcation diagram for the circuit dynamics by selecting the time delay $\tau$ as the control parameter. For each $\tau$, simulate the circuit sufficiently long so that it reaches to either the stable steady state or, in the case of oscillatory dynamics, the stable oscillations. Plot the maximum and minimum $X$ of the stable trajectory $X(t)$ with respect to the control parameter $\tau$.

# 2. Method of steps

We will use the method of steps for simulating DDEs. In this method, we separate the whole simulation into parts of consecutive short simulations of small duration $\tau$. From the initial condition $N(t)$ for $t \in [t_0-\tau,t_0]$, we can perform a short simulation to obtain $N(t)$ for $t \in [t_0, t_0 + \tau]$. Then, we can further perform a short simulation to obtain $N(t)$ for $t \in [t_0+\tau, t_0+2\tau]$. This process can be iterated to advance time until the end of the simulation. In each iteration, only a short time trajectory needs to be saved. 

<center> ![Figure 1](./extra/data/04D/steps.png){width=70%} </center>

**(a)** Implement the method of steps. 

Hint: write a function to perform an iteration of short simulation. This function takes the time trajectory from the previous iteration (or the initial condition for the first iteration) as the input and outputs the time trajectory from the current iteration. 

**(b)** Test the algorithm using the logistic growth model with time delays (see the examples in Part 4B).

# 3. More on the negative feedback loops

In Part 4C, we examined a few negative feedback loops. The loop with either three nodes (Figure 2) or four nodes (Figure 3) can generate oscillatory dynamics. 

**(a)** Find a set of parameters for Equation (2) in Part 4C, so that the system generates similar dynamics as those for the loop with three nodes.

**(b)** Find a set of parameters for Equation (2) in Part 4C, so that the system generates similar dynamics as those for the loop with four nodes.
