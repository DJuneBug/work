Introduction to R Programming
================
Mingyang Lu
10/6/2021

  - [Why Using R?](#why-using-r)
  - [A crash course of R](#a-crash-course-of-r)
      - [Typical data types & math
        operations](#typical-data-types-math-operations)
      - [Vectors](#vectors)
      - [Factors](#factors)
      - [If statement](#if-statement)
      - [For loops](#for-loops)
      - [While statement](#while-statement)
      - [Apply](#apply)
      - [Functions](#functions)
      - [List](#list)
      - [Data frame](#data-frame)
      - [Input/output](#inputoutput)
      - [Package](#package)
      - [Basic plotting](#basic-plotting)
  - [A few notes](#a-few-notes)
      - [Factor v.s. character](#factor-v.s.-character)
      - [Matrix v.s. data frame](#matrix-v.s.-data-frame)
      - [List v.s. vector](#list-v.s.-vector)
  - [Efficient R programming](#efficient-r-programming)
      - [Vectors](#vectors-1)
      - [Vactors](#vactors)
      - [C/Fortran codes](#cfortran-codes)
      - [Compilation](#compilation)
      - [Parallelization](#parallelization)

## Why Using R?

R is a programming language designed for statistical computing and
graphics. Unlike a compiled language, such as C and Fortran, R is
typically used as an interpreted language. There are several reasons why
I choose R here.

  - R is simple to use. If you have some experience with any other
    programming language, it should be pretty easy to learn R.

  - R comes with an interactive environment for programming. Many users
    also use [RStudio](https://www.rstudio.com) for R. It provides an
    integrated environment for coding and scripting and a user-friendly
    Graphic User Interface (GUI), very similar to Matlab. [Here is an
    article comparing R and Matlab.](https://hackr.io/blog/r-vs-matlab)

  - R is cross-platform. Both R and RStudio are available in Windows,
    Mac, and Linux.

  - Many R packages have been developed and are freely accessible for
    statistical analyses and biomedical research. R packages can usually
    be found via (1) [Github](https://github.com); (2) The Comprehensive
    R Archive Network ([CRAN](https://cran.r-project.org)); (3)
    [BioConductor](https://www.bioconductor.org) for bioinformatics.

  - It is not difficult to develop R packages. R also provides interface
    for other languages, such as C++ and Fortran, for computational
    efficiency.

  - R packages can also be easily converted into interactive web app
    using [Shiny](https://shiny.rstudio.com).

To get started, one needs to download and install R and RStudio from the
following websites: [CRAN](https://cran.r-project.org) and
[RStudio](https://www.rstudio.com/). I recommend R version 3.6.3 for
this tutorial.

From the R Console, type the following command to get help.

``` r
help(runif)     # show documentation for the topic -- runif in this example
```

## A crash course of R

I will not provide a detailed R tutorial, as they are already available.
I recommend the following resources for learning R.

  - [An Introduction to
    R](https://cran.r-project.org/doc/manuals/r-release/R-intro.html)
    from [CRAN](https://cran.r-project.org)

  - [R & Bioconductor
    Manual](http://manuals.bioinformatics.ucr.edu/home/R_BioCondManual)
    by Thomas Girke at UC Riverside

  - [Efficient R programming](https://csgillespie.github.io/efficientR/)
    by Colin Gillespie & Robin Lovelace

Here, I will provide a brief overview of R syntax and highlight a few
R’s unique features.

#### Typical data types & math operations

``` r
a = 10 + 3.14    # integer, real number; assignment to a
a*a # a multiplies a
```

    ## [1] 172.6596

``` r
a**2 # square of a, which gives the same value as the previous one
```

    ## [1] 172.6596

``` r
b = 3.0 + 4.0i  # complex number; assignment to b
Mod(b) # The modulus of b
```

    ## [1] 5

``` r
c = (3 + 4 == 7)   # logical; c is TRUE
!c   # not c, which is FALSE
```

    ## [1] FALSE

``` r
d = "Monday"  # character
class(d)  # showing the data type of d
```

    ## [1] "character"

``` r
nchar(d)  # number of characters in a string
```

    ## [1] 6

#### Vectors

``` r
vec = c("Man","Woman","Woman","Man","Woman")   # a vector of characters
length(vec) #length of a vector
```

    ## [1] 5

``` r
vec == "Woman" # logic values comparing each element to "Woman"
```

    ## [1] FALSE  TRUE  TRUE FALSE  TRUE

``` r
which(vec == "Woman") # identifying the indices of the elements being "Woman"
```

    ## [1] 2 3 5

#### Factors

Factor type is an important data type in R. It is commonly used to
represent categorical data.

``` r
vec_factor = as.factor(vec)   # converting the character vector to a factor vector
class(vec);class(vec_factor)  # checking the data types
```

    ## [1] "character"

    ## [1] "factor"

``` r
levels(vec_factor); nlevels(vec_factor)  # levels and the number of levels
```

    ## [1] "Man"   "Woman"

    ## [1] 2

#### If statement

``` r
a = 0
if(a == 1){   # conditions
  print("a equals to 1")
} else {
  print("a is not 1")
}
```

    ## [1] "a is not 1"

#### For loops

``` r
for (i in 1:5) print(i)   # version 1
```

    ## [1] 1
    ## [1] 2
    ## [1] 3
    ## [1] 4
    ## [1] 5

``` r
for (i in seq_len(5)) print(i)   # version 2
```

    ## [1] 1
    ## [1] 2
    ## [1] 3
    ## [1] 4
    ## [1] 5

``` r
v = c(1,2,5,7)
for (i in v){
  print(i)   # version 3
}
```

    ## [1] 1
    ## [1] 2
    ## [1] 5
    ## [1] 7

#### While statement

``` r
i = 0
while(i < 5){
  i = i + 2
  print(i)
}
```

    ## [1] 2
    ## [1] 4
    ## [1] 6

#### Apply

Another unique feature in R. Apply performs a function iteratively
through an array or matrix. It’s usually more efficient than a for-loop.
Syntax: apply(X, MARGIN, FUN). Here, X is an array or matrix. MARGIN=1
performs the specified function by rows, MARGIN=2 by columns. FUN is the
function to apply.

``` r
mat = matrix(rnorm(16), nrow = 4)    # generating a random matrix of 4 x 4
mat
```

    ##            [,1]        [,2]       [,3]       [,4]
    ## [1,] -1.0247938 -0.48199147  0.1375363  1.1490142
    ## [2,]  0.3130703 -0.97092758  1.1602730  0.6091397
    ## [3,]  1.5600968  0.08653021  1.5506402  0.8648133
    ## [4,]  0.9314584  1.12416772 -0.1052525 -0.6225107

``` r
apply(mat, 1, sum)   # row sum
```

    ## [1] -0.2202348  1.1115554  4.0620806  1.3278629

``` r
rowSums(mat)   # An alternative way to do row sum
```

    ## [1] -0.2202348  1.1115554  4.0620806  1.3278629

``` r
apply(mat, 2, sum)   # column sum
```

    ## [1]  1.7798317 -0.2422211  2.7431970  2.0004565

``` r
colSums(mat)  # An alternative way to do column sum
```

    ## [1]  1.7798317 -0.2422211  2.7431970  2.0004565

There are other apply-like functions, such as lappy, sappy, tapply,
*etc.* [Check here for more
details.](https://www.datacamp.com/community/tutorials/r-tutorial-apply-family)

#### Functions

``` r
myfunction <- function(x) {    # a simple function to perform x square
  x*x
}
b = myfunction(4)
print(paste0("b = ",b))
```

    ## [1] "b = 16"

#### List

Lists can contain elements of different types.

``` r
my_list = list("a", c(1,2,3), FALSE, 3.14)  # Defining a new list
my_list[[1]]   # the first element
```

    ## [1] "a"

``` r
my_list[[2]]   # the second element
```

    ## [1] 1 2 3

``` r
names(my_list) = c("letters", "array", "TF", "pi")  # naming list elements
my_list$TF   # retrieve elements by names
```

    ## [1] FALSE

``` r
my_vector = unlist(my_list)   # convert the list to a vector
my_vector
```

    ## letters  array1  array2  array3      TF      pi 
    ##     "a"     "1"     "2"     "3" "FALSE"  "3.14"

#### Data frame

Data frame is widely used in R. It’s similar to a matrix but allows
mixed data types in it.

``` r
my_data = data.frame(
          id = c(1:5),
          atom = c("N","CA","CB","C","O"),
          mass = c(14, 12, 12, 12, 16),
          size = c(1.2, 1.4, 1.4, 1.4, 1.1)
)
print(my_data)
```

    ##   id atom mass size
    ## 1  1    N   14  1.2
    ## 2  2   CA   12  1.4
    ## 3  3   CB   12  1.4
    ## 4  4    C   12  1.4
    ## 5  5    O   16  1.1

``` r
colnames(my_data)
```

    ## [1] "id"   "atom" "mass" "size"

``` r
str(my_data)      # get the structure 
```

    ## 'data.frame':    5 obs. of  4 variables:
    ##  $ id  : int  1 2 3 4 5
    ##  $ atom: Factor w/ 5 levels "C","CA","CB",..: 4 2 3 1 5
    ##  $ mass: num  14 12 12 12 16
    ##  $ size: num  1.2 1.4 1.4 1.4 1.1

``` r
my_data$mass      # retrive a column
```

    ## [1] 14 12 12 12 16

``` r
my_data$backbone = c(T, T, F, T, T)   # add a column
print(my_data)
```

    ##   id atom mass size backbone
    ## 1  1    N   14  1.2     TRUE
    ## 2  2   CA   12  1.4     TRUE
    ## 3  3   CB   12  1.4    FALSE
    ## 4  4    C   12  1.4     TRUE
    ## 5  5    O   16  1.1     TRUE

``` r
my_data = rbind(my_data, c(6, "S", 32, 1.6, F))   # add a row
```

    ## Warning in `[<-.factor`(`*tmp*`, ri, value = "S"): invalid factor level, NA
    ## generated

``` r
print(my_data)
```

    ##   id atom mass size backbone
    ## 1  1    N   14  1.2     TRUE
    ## 2  2   CA   12  1.4     TRUE
    ## 3  3   CB   12  1.4    FALSE
    ## 4  4    C   12  1.4     TRUE
    ## 5  5    O   16  1.1     TRUE
    ## 6  6 <NA>   32  1.6    FALSE

#### Input/output

``` r
save(my_data,file = "my_data.Rdata")    # save the data frame my_data to file
saveRDS(my_data, file = "my_data.RDS")  # save my_data to an RDS file
load("my_data.Rdata")   # read data from an Rdata file; my_data, if exist, would be overwritten
my_data2 = readRDS("my_data.RDS")   # read data from an RDS file, assign it to another variable
```

#### Package

The following code works to install/remove packages (not in the R
markdown format to avoid adding/removing packages)

    if(! "umap" %in% rownames(installed.packages())) {      # check if the package exists
      install.packages("umap")   # if not, install "umap"
    }
    library("umap")    # load the umap library
    help(umap)
    remove.packages("umap")    # remove it ...

#### Basic plotting

``` r
x = seq_len(5)
y = x**2
plot(x, y)       # plot points
```

![](01A_files/figure-gfm/unnamed-chunk-15-1.png)<!-- -->

``` r
curve(x**2)      # plot f(x) = x*x
```

![](01A_files/figure-gfm/unnamed-chunk-15-2.png)<!-- -->

``` r
y = data.frame(xvalues = rnorm(1000), yvalues = rnorm(1000))    # 1000 random points in 2D
plot(y$xvalues, y$yvalues)     # scatter plot
library(ggplot2)
```

    ## Registered S3 methods overwritten by 'tibble':
    ##   method     from  
    ##   format.tbl pillar
    ##   print.tbl  pillar

![](01A_files/figure-gfm/unnamed-chunk-15-3.png)<!-- -->

``` r
ggplot(y, aes(x = xvalues, y = yvalues)) + 
  stat_density2d(aes(fill = ..density..), geom = "raster", contour = FALSE)
```

![](01A_files/figure-gfm/unnamed-chunk-15-4.png)<!-- -->

## A few notes

#### Factor v.s. character

#### Matrix v.s. data frame

#### List v.s. vector

## Efficient R programming

#### Vectors

#### Vactors

#### C/Fortran codes

#### Compilation

#### Parallelization
